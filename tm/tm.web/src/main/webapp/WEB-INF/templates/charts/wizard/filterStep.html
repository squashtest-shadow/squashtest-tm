<!--

        This file is part of the Squashtest platform.
        Copyright (C) 2010 - 2015 Henix, henix.fr

        See the NOTICE file distributed with this work for additional
        information regarding copyright ownership.

        This is free software: you can redistribute it and/or modify
        it under the terms of the GNU Lesser General Public License as published by
        the Free Software Foundation, either version 3 of the License, or
        (at your option) any later version.

        this software is distributed in the hope that it will be useful,
        but WITHOUT ANY WARRANTY; without even the implied warranty of
        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        GNU Lesser General Public License for more details.

        You should have received a copy of the GNU Lesser General Public License
        along with this software.  If not, see <http://www.gnu.org/licenses/>.

-->
<div th:fragment="chart-wizard-filter">

{{#*inline "filter"}}


<input type="checkbox" id="filter-selection-{{id}}" name="{{id}}" />
    {{i18n this.label prefix="chart.column."}}
<select id="filter-operation-select-{{id}}" class="filter-operation-select" name="{{id}}">
{{#each  operations}}  

<option value="{{this}}">
    {{i18n this prefix="chart.operation."}}
</option>

{{/each}}   
</select>

{{#equal dataType "NUMERIC"}} 
<input type="text" id="first-filter-value-{{id}}" name="{{id}}" />
<input type="text" id="second-filter-value-{{id}}" name="{{id}}" />
{{/equal}}

{{#equal dataType "STRING"}}
<input type="text" id="first-filter-value-{{id}}" name="{{id}}" />
{{/equal}}

{{#equal dataType "DATE"}}
<input class="date-picker" id="first-filter-value-{{id}}" name="{{id}}" />
<input class="date-picker" id="second-filter-value-{{id}}" name="{{id}}"/>
{{/equal}}


{{#equal dataType "EXECUTION_STATUS"}}
<select id="first-filter-value-{{id}}" name="{{id}}">
{{#each  data.executionStatus}}  
<option value="{{this.name}}">
    {{this.level}} - {{i18n this.i18nkey}}
</option>
{{/each}}   
</select>
{{/equal}}

{{#equal dataType "LEVEL_ENUM"}}
<select id="first-filter-value-{{id}}" name="{{id}}">
{{#each  (lookup data.levelEnums label)}}  
<option value="{{this.name}}">
    {{this.level}} - {{i18n this.i18nkey}}
</option>
{{/each}}   
</select>
{{/equal}}


{{#equal dataType "INFO_LIST_ITEM"}}
<span id="info-list-filter-container-{{id}}" name="{{label}}"/>
{{/equal}}




<br />
{{/inline}}


<br />

{{#each attributes.columnPrototypes}}

  {{#if (contains ../attributes.selectedEntity @key)}}
  <div class="sq-tg expand">
 <div class="tg-head">
{{i18n @key prefix='chart.entityType.'}}          
</div> 

<div class="tg-body">
{{#each  this}}  

{{#if (contains this.role "FILTER")}}
{{#if (contains ../../attributes.selectedAttributes id)}} 
{{> filter  operations=(intersect (lookup ../../attributes.columRoles "FILTER") (lookup ../../attributes.dataTypes dataType)) data=../../attributes}}
{{/if}}
{{/if }}
{{/each}}  
</div>

 </div>  
 {{/if}}
{{/each}}  



</div>




<div th:fragment="chart-wizard-info-list">
 
 <select id="info-list-{{id}}" class="info-lists" name="{{id}}">
{{#each infolists}}
 <option value="{{this.code}}">
 {{#if (eq this.createdBy "system")}} 
  {{i18n this.label}}
  {{else}}
  {{this.label}}
  {{/if}}
 </option> 
{{/each}}
</select>

<span id="info-list-item-container-{{id}}"/>

</div>



<div th:fragment="chart-wizard-info-list-item">
 <select id="first-filter-value-{{id}}" name="{{id}}">
{{#each items}}
 <option value="{{this.code}}">  
 {{#if this.isSystem}} 
  {{i18n this.label}}
  {{else}}
  {{this.label}}
  {{/if}}
 </option> 
{{/each}}
</select>
</div>




